## 数理统计

[TOC]

### 致谢

感谢在这门课程给我提供帮助的郭锐同学，让我总结了数理统计的知识，写成这份笔记。（书中有些知识点并未总结，复习需要同时看书复习）

### 第一章 抽样和抽样分布

#### 1.1母体和子样

母体：所研究对象的全体元素组成的集合。

个体：母体中的每一个元素。

母体分布：数量指标取不同数值比例的分布 => 相对应随机变量x的概率分布

母体**X**的分布函数F(x),记作X~F(X) 	
$$
F(x) = P\{X \leq x \}
$$

1. 子样(样本):从具体中抽取部分个体
2. 样品:子样中的每一个个体
3. 子样容量:子样的个数
4. 简单子样：1.子样中各个个体独立分布 2.每个随机变量分布为其母体分布

子样分布的三种形式：

1. 频数和频率分布
2. 经验分布函数
3. 直方图

子样数字特征：

1. 子样平均数和子样方差
   $$
   \begin{align*}
   &子样平均(数): \bar x = \frac{1}{n}\sum_{i=1}^{n}{x_i} \\
   &子样方差: s^2 = \frac{1}{n}\sum_{i=1}^{n}(x_i - \bar x)^2 = \frac{1}{n}\sum_{i=1}^{n}x_i^2 - \bar x^2 \\
&子样k阶原点矩：a_k = \frac{1}{n}\sum_{i=1}^{n}x_i^k \\
   &子样k阶中心矩: b_k = \frac{1}{n}\sum_{i=1}^{n}(x_i - \bar x)^k
   \end{align*}
   $$
   
   
   
2. 子样中位数和子样极差

$$
\begin{align*}
& 子样中位数: me = \begin{cases}
					X_(\frac{n+1}{2})  \qquad 当n是奇数\\
					X_(\frac{n}{2} + 1) \qquad 当n是偶数\\
				\end{cases}  \\
& 子样极差: R = x_(n) - x_(1) = \max \limits_{1 \leq x \leq n} x_i - \min \limits_{1 \leq x \leq n} x_i
\end{align*}
$$

​	统计量：不含任何未知参数的样本的函数	

#### 1.2一些常用的抽样分布

##### 正态母体中$\bar X$的分布

$$
\begin{align*}
&设X_1,X_2,\cdots,X_n是独立分布随机变量，且每个随机变量服从正态分布N（\mu,\sigma^2),则平均数\bar X= \frac{1}{n}\sum_{i=1}^nX_i服从正态分布N(\mu,\frac{\sigma^2}{n}) \\
&E(\bar X) = E(\frac{1}{n}\sum_{i=1}^nX_i)=\frac{1}{n}\sum_{i=1}^nEX_i=\frac{n\mu}{n}=\mu \\
&D(\bar X) = D(\frac{1}{n}\sum_{i=1}^nX_i)=\frac{1}{n^2}\sum_{i=1}^nDX_i=\frac{n\sigma^2}{n^2}=\frac{\sigma^2}{n} \\
&U服从标准正态分布N(0,1),对于给定的\alpha,查表可使得 \\
& \qquad \qquad  P\{ U \geq u_\alpha \} = \alpha \\
&的u_\alpha为标准正态分布的上侧分位数。
\end{align*}
$$

$$
\begin{align*}
&三种重要的抽样分布： \chi^2分布 \quad  t分布 \quad  F分布 
\end{align*}
$$

##### $\chi^2$分布

$$
\quad \begin{align*}
&设X_1,X_2,\cdots,X_n是独立同分布随机变量，每一个随机变量服从标准正态分布N(0,1),则随机变量\chi^2=X_1^2+X_2^2+ \cdots +X_n^2的分布密度是\\
& \qquad \qquad \qquad \qquad \qquad \qquad f(x) = \begin{cases}
				\frac{1}{2^\frac{n}{2}\Gamma(\frac{n}{2})}x^(\frac{n}{2}-1^)e^-\frac{x}{2},\qquad x >0 \\
				0, \qquad x \leq 0
			   \end{cases} \\
&其中\Gamma(\frac{n}{2})是伽马函数在\frac{n}{2}处的值。这种分布称为自由度为n的\chi^2分布,记作\chi^2(n)。随机变量\chi^2简称\chi^2变量。\left(\Gamma(n) = \int_{0}^{+\infty}x^{n-1}e^{-x}dx\right)\\
&\chi^2分布具有下列性质: \\
&1. E\chi^2 = n,\, D\chi^2=2n \\
&2.设两个\chi^2变量\chi^2_1和\chi^2_2相互独立，且\chi^2_1,\chi^2_2分别有自由度n_1和n_2,则\chi^2_1+\chi^2_2是自由度为n_1+n_2的\chi^2变量。这个性质称为\chi^2变量的可加性。
\end{align*}
$$

##### t分布

$$
\begin{align*}
&设随机变量X服从标准正态分布N(0,1),随机变量Y服从自由度为n的\chi^2分布，且X与Y相互独立，则 \\
&\qquad \qquad \qquad \qquad\qquad \qquad\qquad \qquad  T = \frac{X}{\sqrt{\frac{Y}{n}}} \\
&的分布密度为\\
&\qquad \qquad \qquad \qquad\qquad \qquad	f(t) = \frac{\Gamma(\frac{n+1}{2})}{\sqrt{n\pi}\Gamma(\frac{n}{2})}(1 + \frac{t^2}{n})^{-\frac{n+1}{2}} \qquad, -\infty < t < \infty \\
&这种分布称为自由度为n的t分布，简记为t(n).随机变量T则简称T变量。\\
&对于给定的\alpha（0 < \alpha < \frac{1}{2}）,存在正数t_\alpha(n)使 \\
&\qquad \qquad \qquad \qquad\qquad \qquad	\int_{t_\alpha(n)}^\infty f(t)dt = \alpha \\
&则称t_\alpha(n)为t分布的上侧分位数。 \\
&1.P\{T > t_\alpha\} = \alpha \\
&2.P\{|T| > t_\alpha\} = \alpha \\
&3.-t_\alpha = t_{1-\alpha}
\end{align*}\qquad \qquad \qquad\qquad \qquad \qquad \qquad
$$

##### F分布

$$
\begin{align*}
& 设X和Y分布服从自由度为n_1,n_2的\chi^2分布，且X与Y相互独立，则 \\
& \qquad \qquad \qquad \qquad \qquad\qquad \qquad	F = \frac{\frac{X}{n_1}}{\frac{Y}{n_2}} \\
& 这种分布称为第一自由度为n_1,第二自由度为n_2的F分布，或自由度为(n_1,n_2)的F分布，记为F(n_1,n_2),随机变量F简称F变量. \\
&若对于给定的\alpha(0<\alpha<1),存在正数F_\alpha(n_1,n_2)使 \\
&\qquad \qquad \qquad \qquad \qquad \qquad \qquad \int_{F_\alpha(n_1,n_2)}^\infty f(z) dz = \alpha \\
&则称F_\alpha(n_1,n_2)为F分布的上侧数。\\
&如果F \sim F(n_1,n_2)，那么\frac{1}{F} \sim F(n_2,n_1)
\end{align*} \qquad \qquad
$$

### 第二章 参数估计

$$
\begin{align*}
&统计推断\begin{cases}
			参数估计 \\
			假设检验
		\end{cases} \\ 
&参数估计又分为点估计和区间估计。 \\
&参数估计是利用样本信息对总体分布中的未知参数作出估计 \\
&\begin{cases}
	定值估计 \rightarrow 点估计 \\
	范围估计 \rightarrow 区间估计
	\end{cases} \\
\end{align*} \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad\qquad \qquad \qquad
$$

#### 2.1点估计

点估计包含了矩法(数字特征法)和最大似然估计法

##### 矩阵

$$
\begin{align*}
& 矩阵思想：用样本矩去估计总体的相应矩。\\
& 样本的k阶原点矩在n\rightarrow \infty时收敛于总体的k阶原点矩 \\
& 当n \rightarrow \infty 时，A_k = \frac{1}{n}\sum_{i=1}^nX_i^k \rightarrow u_k=EX^k \\
& 当n \rightarrow \infty 时, B_k = \frac{1}{n}\sum_{i=1}^n(X_i-\bar X)^2 \rightarrow V_k = E(X-EX)^k \\
& 即\begin{cases}
	A_k = u_k(\theta)\\
	B_k = v_k(\theta) \\
	\end{cases}   \qquad \Longrightarrow \hat\Theta_矩 = \hat\Theta(x_1,x_2,\cdots,x_n) \\
& 例1.设总体X \sim B(N,p),N已知，p未知，X_1,X_2,\cdots,X_n是一组样本，求p的矩法估计 \\
& 解：依矩阵\begin{cases}
				\bar X = EX \\
				\bar X = Np \\
			\end{cases} \Longrightarrow P = \frac{\bar X}{N}

\end{align*} \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad
$$

##### 极大似然估计法

$$
\begin{align*}
&极大似然估计法：选取样后，要求出的未知量是使得当前样本(结果)被选出的概率最大的值，称此值为未知参数的极大似然法。 \\
\\\\
&当X是离散型总体时： \\
&\qquad \qquad \qquad P=P\{x;\theta_1,\theta_2,\cdots,\theta_n \},\qquad \theta_1,\theta_2,\cdots,\theta_n为未知数 \\
&\qquad \qquad \qquad 	P = \prod_{i=1}^{n}P\{X = x_i\}=L(\theta_1,\theta_2,\cdots,\theta_k) \Longrightarrow 似然函数 \\
&使得L函数取最大值的\theta_1,\cdots,\theta_n取值为\theta_1,\cdots,\theta_n的极大似然函数 \\ \\
&例1.设总体X服从参数为\lambda(\lambda>0)的泊松分布,求未知参数\lambda的极大似然估计量\\
&解：设(X_1,X_2,\cdots,X_n)是从总体X中选取的样本 \\
&	\qquad \qquad \qquad P\{x;\lambda \}=P\{X=k\}=\frac{\lambda^k}{k!}e^{-\lambda} \qquad\qquad (k=0,1,2,\cdots) \\
& 似然函数为L(\lambda) = P\{ X_1=x_1,X_2=x_2,\cdots,X_n=x_n\} = \prod_{i=1}^nP\{X_i = x_i\}=\prod_{i=1}^n\frac{\lambda^x_i}{x_i!}e^{-\lambda} \\
&因为要求L函数最大值,可求L^{\prime}(\lambda)与L''(\lambda)\\
&对L(\lambda)两侧求对数: \\
&\qquad \qquad \qquad \qquad \qquad \qquad \ln L(\lambda) = -n\lambda + \ln\lambda(\sum_{i=1}^nX_i)-\sum_{i=1}^n\ln(X_i!) \\
&使L(\lambda)取最大值的\lambda也能是\ln(\lambda)取最值 \\
&\ln(\lambda)两侧对\lambda求导：\\
&\qquad\qquad \qquad\qquad \qquad\qquad \frac{d\ln L(\lambda)}{d\lambda} = -n + \frac{1}{n}(\sum_{i=1}^n\lambda_i) = 0 \qquad\qquad \Longrightarrow \qquad\qquad \lambda = \bar x \\
&把\lambda=\bar x代入 \frac{d^2(\ln (\lambda))}{d\lambda^2}中 \\
&可得：\frac{d^2(\ln (\lambda))}{d\lambda^2} < 0 \Longrightarrow \lambda=\bar x使得极大似然函数取得最大值 \\
\\\\
&当X是连续型总体时: \\
&考察样本落在样本值指定区域的概率最大 \\
&P\{x_1-dx_1 < X \leq x_1,x_2-dx_2 < X \leq x_2, \cdots,x_n-dx_n < X \leq x_n, \}= \\
& P\{x_1-dx_1 < X \leq x_1\}P\{x_2-dx_2 < X \leq x_2\}\cdots P\{x_n-dx_n < X \leq x_n\} \approx \prod_{i=1}^n[f(x_i;\theta_1,\theta_2,\cdots,\theta_k)dx_i]\\
&=[\prod_{i=1}^nf(x_i;\theta_1,\theta_2,\cdots,\theta_k)]dx_1dx_2\cdots dx_n \\
&似然函数L(\theta_1,\theta_2,\cdots,\theta_n) = \prod_{i=1}^nf(x_i;\theta_1,\theta_2,\cdots,\theta_n)=\prod_{i=1}^nf(x_i) \\\\\\
&例2设总体X\sim E(\lambda),(x_1,x_2,\cdots,x_n)是取自总体X的样本值，\lambda>0,求\lambda的极大似然量 \\
&解: X的密度函数f(x;\lambda)= \begin{cases}
							\lambda e^{-(\lambda x)}, x\geq 0 \\
							0, x<0 \\
							\end{cases} \\
&似然函数:L(\lambda)=\prod_{i=1}^nf(x_i)=\prod_{i=1}^n\lambda e^{(-\lambda x_i)}=\lambda^ne^{(-\lambda \sum_{i=1}^nX_i)} \\
&两侧取对数 \ln L(\lambda) = n \ln \lambda - \lambda \sum_{i=1}^n X_i \\
& \frac{d\ln L(\lambda)}{d \lambda} = \frac{n}{\lambda} - \sum_{i=1}^{n}Xi = 0 \Longrightarrow \lambda = \frac{1}{\bar X} \\
&当\lambda = \frac{1}{\bar X}时，\frac{d^2\ln (\lambda)}{d \lambda^2} < 0 \\
&\lambda的极大似然量为\frac{1}{\bar X}
\end{align*} \qquad\qquad\qquad
$$

#### 2.2估计量的好坏标准

标准有三种: 无偏性、相合性和优效估计

##### 无偏性

若参数$\theta$的估计量$\hat \theta$满足

​									E$\hat \theta$ = $\theta$

则称$\hat  \theta$是$\theta$的无偏估计(量)

如果E$\hat \theta$ $\neq \theta$,那么E$\hat \theta - \theta$ 称为估计量$\hat \theta$的偏差。

若 $\displaystyle \lim_{n \rightarrow \infty} E\hat \theta = \theta$,则称$\hat \theta$是$\theta$的渐近无偏估计(量)。

##### 相合估计量

若当n $\rightarrow \infty$时，$\hat \theta$依概率收敛到$\theta$,即对任意$\varepsilon > 0$,有 

​					$\displaystyle \lim_{n \rightarrow \infty} P\{|\hat \theta - \theta| < s\} = 1$

则称$\hat \theta$是$\theta$的相合估计(量)或一致估计(量)

子样k阶矩是母体k阶矩的相合估计量

设$\hat \theta$是$\theta$的无偏估计量，且$\displaystyle \lim_{n \rightarrow \infty}D \hat \theta = 0$,则$\hat \theta$是$\theta$的相合估计量

##### 优效估计

设$\hat \theta_1 和 \hat \theta_2$都是$\theta$的无偏估计量，若对任意子样容量n有

​									D$\hat \theta_1$ < D$\hat \theta_2$

则称$\hat \theta_1比\hat \theta_2有效$.

罗—克拉美不等式:

1.连续母体分布情况:

​									D$\hat \theta \geq \frac{1}{n\int_{-\infty}^{\infty}(\frac{d\ln f(x;\theta)}{d\theta})^2f(x;{\theta})dx}$ 

2.离散母体分布情况:

​									D$\hat \theta \geq \frac{1}{n \sum_{x} (\frac{d \ln P(x;\theta)}{d \theta})^2P(x;\theta)}$

如果$\theta$的无偏估计量$\hat \theta_0$的方差等于罗—克拉美下界，则称$\hat \theta_0$是$\theta$的优效估计(量)

 记罗—克拉美下界为$I_R$.若$\theta$的无偏估计量为$\hat \theta $,则$\frac{I_R}{D\hat \theta}$称为估计量$\hat \theta$的(有)效率，记为e($\hat \theta$)。

若估计量$\hat \theta$满足

​									$\displaystyle \lim_{n \rightarrow \infty}e(\hat \theta) = 1$

则称$\hat \theta$是$\theta$的渐近优效估计(量)。

#### 2.3区间估计

参数的区间估计就是由子样给出参数的估计范围，并使未知参数在其中具有指定的概率。

区间估计的一般做法是：

设母体X的分布函数是F(x;$\theta$),其中$\theta$是未知参数，从母体中抽取子样($X_1,X_2,\cdots,X_n$),作统计量$\theta_1(X_1,X_2,\cdots,X_n)$和$\theta_2(X_1,X_2,\cdots,X_n)$,使

​									$P\{\theta_1 < \theta <\theta_2 \} = 1 - \alpha$

其中($\theta_1,\theta_2$)称为$\theta$的置信区间，$\theta_1$和$\theta_2$分别称为置信下限和置信上限，$1-\alpha$称为置信概率。

- 置信区间的长度$\theta_2 - \theta_1$反映了估计精度,$\theta_2 - \theta_1$越小，估计精度越高
- $\alpha$反映了估计的可靠度，$\alpha$越小，越可靠。$\alpha$越小，1-$\alpha$越大，估计的可靠度越高，但，这时，$\theta_2 - \theta_1$往往增大，因而估计精度降低
- $\alpha$确定后, 置信区间的选取方法不唯一,常选最小的一个

**处理"可靠性与精度关系"的原则:**

**求参数置信区间，先保证可靠性，再提高精度**

##### 非正态母体的情形(大子样)

设母体的期望$EX=\mu$与方差$DX = \sigma^2$均未知，用大子样($n \geq 50$)对$\mu$作区间估计

取U=$\frac{\bar X -\mu}{S/ \sqrt{n}} \sim N(0,1)$

由P(|U|<$u_\frac{\alpha}{2}$) = 1 - $\alpha$得$\mu$的置信区间： ($\bar X - u_\frac{\alpha}{2}\frac{S}{\sqrt{n}},\bar X + u_\frac{\alpha}{2}\frac{S}{\sqrt{n}}$)

##### 正态母体的情况

###### 一个正态总体的情况

- 方差$\sigma^2$已知，$\mu$的置信区间: ($\bar X - u_{\frac{\alpha}{2}}\frac{\sigma_0}{\sqrt{n}},\bar X+u_{\frac{\alpha}{2}}\frac{\sigma_0}{\sqrt{n}}$)
- 方差$\sigma^2$未知，$\mu$的置信区间: ($\bar X - t_{\frac{\alpha}{2}(n-1)}\frac{S^*}{\sqrt{n}},\bar X+t_{\frac{\alpha}{2}(n-1)}\frac{S^*}{\sqrt{n}}$) 其中S*=$\sqrt{\frac{1}{n-1}\sum_{i=1}^n(X_i - \bar X)^2}$
- 当$\mu$未知时，方差$\sigma^2$的置信区间:($\frac{(n-1)S^{*2}}{\chi^2_{(\frac{\alpha}{2})(n-1)}},\frac{(n-1)S^{*2}}{\chi^2_{(1-\frac{\alpha}{2})(n-1)}}$)

###### 两个正态母体的情况

（$X_1,X_2,\cdots,X_n$）为母体$X\sim N(\mu_1,\sigma^2_1)$的子样，($Y_1,Y_2,\cdots,Y_m$)为母体$Y \sim N(\mu_2,\sigma^2_2)$的子样，$\bar X,$$S_1^*2;\bar Y,S_2^*2$分别表示两子样的均值与方差置信概率为1-$\alpha$

- $\sigma_1^2,\sigma_2^2已知，考虑\mu_1-\mu_2的置信区间$：$\left((\bar X- \bar Y) - u_{\frac{\alpha}{2}}\sqrt{\frac{\sigma^2_1}{n}+\frac{\sigma^2_2}{m}} ,(\bar X- \bar Y) + u_{\frac{\alpha}{2}}\sqrt{\frac{\sigma^2_1}{n}+\frac{\sigma^2_2}{m}}\right)$
- $\sigma_1^2,\sigma_2^2未知(但\sigma_1^2=\sigma_2^2=\sigma^2),\mu_1-\mu_2的置信区间:\left( (\bar X-\bar Y) \pm t_\frac{\alpha}{2}(n+m-2)\sqrt{\frac{1}{n}+\frac{1}{m}}W\right)，\qquad 其中W=\sqrt{\frac{(n-1)S_1^*2+(m-1)S_2^*2}{n+m-2}}$
- $\sigma^2_1,\sigma^2_2未知，n,m>50,\mu_1-\mu_2的置信区间:\left((\bar X - \bar Y ) \pm \mu_{\frac{\alpha}{2}}\sqrt{\frac{S_1^2}{n}+\frac{S_2^2}{m}} \right)$
- $\sigma_1^2,\sigma_2^2未知,但n=m,$$\mu_1,\mu_2的置信区间：\left((\bar X-\bar Y)\pm t_{\frac{\alpha}{2}}(n-1)\frac{S_z^*}{\sqrt{n}}\right)$,$其中S_z^*=\sqrt{\frac{1}{n-1}\sum_{i=1}^n\left((X_i-Y_i)-(\bar X - \bar Y)\right)^2}$
- $方差比\frac{\sigma_1^2}{\sigma_2^2}的置信区间(\mu_1,\mu_2未知):\left(F_{1-\frac{\alpha}{2}}(m-1,n-1)\frac{S_1^{*2}}{S_2^{*2}}\right)$
- $当\mu_1,\mu_2已知时，方差比\frac{\sigma_1^2}{\sigma_2^2}的置信区间:\left(\frac{\frac{m}{n}*\frac{\sum_{i=1}^n(X_i-\mu_1)^2}{\sum_{j=1}^m(Y_j-\mu_2)^2}}{F_{\frac{\alpha}{2}}(n,m)},\frac{\frac{m}{n}*\frac{\sum_{i=1}^n(X_i-\mu_1)^2}{\sum_{j=1}^m(Y_j-\mu_2)^2}}{F_{1-\frac{\alpha}{2}}(n,m)}\right)$

##### 单侧置信区间

若置信区间形为$(\theta_1,\infty)$,则称为$\theta_1$称为单侧置信下限；若置信区间形为$(-\infty,\theta_2)$,则称为$\theta_2$称为单侧置信上限。置信区间$(\theta_1,\infty)和(-\infty,\theta_2)$都称为单侧置信区间。

| 估计对象                              | 对母体(或子体)要求             | 具有单侧置信上限                                             | 具有单侧置信下限                                             |
| ------------------------------------- | ------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 平均数$\mu$                           | 正态母体，方差$\sigma_0^2$已知 | $\left(-\infty,\bar X + \mu_{\alpha}\frac{\sigma_0}{\sqrt{n}} \right)$ | $\left(\bar X-\mu_{\alpha}\frac{\sigma_0}{\sqrt{n}},\infty\right)$ |
| 平均数$\mu$                           | 大子样                         | $\left(-\infty,\bar X + \mu_{\alpha}\frac{S}{\sqrt{n}} \right)$ | $\left(\bar X-\mu_{\alpha}\frac{S}{\sqrt{n}},\infty\right)$  |
| 平均数$\mu$                           | 正态母体                       | $\left(-\infty,\bar X+t_{\alpha}(n-1)\frac{S^*}{\sqrt{n}} \right)$ | $\left(\bar X-t_{\alpha}(n-1)\frac{S^*}{\sqrt{n}},\infty \right)$ |
| 平均数之差$\mu_1-\mu_2$               | 大子样                         | $\left(-\infty,\bar X_1 -\bar X_2 + u_{\alpha}\sqrt{\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2}}\right)$ | $\left(\bar X_1 -\bar X_2 -u_{\alpha}\sqrt{\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2}},\infty\right)$ |
| 平均数之差$\mu_1-\mu_2$               | 两个正态母体，方差相等         | $\left(-\infty,\bar X_1 - \bar X_2 + t_{\alpha}(n_1+n_2-2)\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}S^*\right)$ | $\left(\bar X_1 - \bar X_2 - t_{\alpha}(n_1+n_2-2)\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}S^*,\infty\right)$ |
| 方差$\sigma^2$                        | 正态母体                       | $\left(-\infty,\frac{(n-1)S^{*2}}{\chi_{1-\alpha}^2(n-1)}\right)$ | $\left(\frac{(n-1)S^{*2}}{\chi_{\alpha}^2(n-1)},\infty\right)$ |
| 方差比$\frac{\sigma_1^2}{\sigma_2^2}$ | 两个正态母体                   | $\left(-\infty,F_{\alpha}(n_2-1,n_1-1)\frac{S_1^{*2}}{S_2^{*2}}\right)$ | $\left(F_{1-\alpha}(n_2-1,n_1-1)\frac{S_1^{*2}}{S_2^{*2}},\infty\right)$ |



### 第三章 假设检验

$$
\begin{cases}
	参数假设检验\begin{cases}
					双侧检验 \\
					单侧检验
				\end{cases} \\
	非参数假设检验\begin{cases}
					分布检验 \\
					符合检验 \\
					秩和检验 \\
				\end{cases}
\end{cases} \qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad \\
检验种类:\begin{cases}
			u检验\rightarrow 利用正态分布检验 \\
			\chi^2检验 \rightarrow 利用\chi^2分布检验 \\
			t检验 \rightarrow 利用t分布检验 \\
			F检验 \rightarrow 利用F分布检验
		\end{cases}
\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad
$$

#### 3.1假设检验初述，二类错误

##### 假设检验

假设检验是指施加于一个或多个母体的概率分布或参数的假设. 所作假设可以是正确的,也可以是错误的. 为判断所作的假设是否正确, 从母
体中抽取子样,根据子样的取值,按一定原则进行检验, 然后作出接受或拒绝所作假设的决定.

假设检验分为二类:

- 参数假设检验：对母体分布中的参数作某项假设，一般是对母体的数字特征作一项假设，用母体中子样检验此项假设是否成立。
- 分布假设检验：对母体分布作某项假设，用母体中子样检验此项假设是否成立。

$$
参数假设检验:\begin{cases}
			检验母体平均数 \\
			检查两个母体平均数相等 \\
			检查母体方差 \\
			检查两个母体方差相等
			\end{cases}
$$

假设检验在工程技术中称为**差异显著性检验**。在假设检验中，小概率$\alpha$通常取为1%或5%或100%。$\alpha$**称为显著水平**。
$$
\begin{align*}
&若\bar x 落在\left(\mu_0 - \mu_{\frac{\mu}{2}}\frac{\sigma_0}{\sqrt{n}},\mu_0+\mu_{\frac{\mu}{2}}\frac{\sigma_0}{\sqrt{n}}\right)中，则接受H_0;若\bar x落在此区间外，则拒绝H_0. \\
&区间|\bar x - \mu_0| < \mu_{\frac{\alpha}{2}}\frac{\sigma_0}{\sqrt{n}}称为\bar x 的接受域 \\
&区间|\bar x - \mu_0| \geq \mu_{\frac{\alpha}{2}}\frac{\sigma_0}{\sqrt{n}}称为\bar x 的拒绝域或临界域 \\
&点\mu_0 - \mu_{\frac{\alpha}{2}}\frac{\sigma_0}{\sqrt{n}}和\mu_0+\mu_{\frac{\alpha}{2}}\frac{\sigma_0}{\sqrt{n}}分别称为\bar x 的临界下限和临界上限。统称为临界限。
\end{align*} \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad
$$
引例:某厂生产的螺钉,按标准强度为$68/mm^2$, 而实际生产的强度X 服$N(\mu,3.62 )$.    若E(X)=$\mu$=68,则认为这批螺钉符合要求,否
则认为不符合要求.为此提出如下假设:
 														$H_0:\mu=68$		     **称为原假设或零假设**
原假设的对立面:							$H_1:\mu \neq 68$ 						**称为备择假设**

**假设检验的任务：必须在原假设与备择假设之间作一选择**

在给定$\alpha$的前提下,接受还是拒绝原假设完全取决于子样值, 因此所作检验可能导致以下两类错误的产生：
$$
\begin{cases}
	第一类错误:弃真错误 \\
	第二类错误:取伪错误
\end{cases} 
$$
![image-20210115113143536](C:\Users\Ally\AppData\Roaming\Typora\typora-user-images\image-20210115113143536.png)

**注意:**

1. 一般,作假设检验时,先控制犯第一类错误的概率$\alpha$,在此基础上使$\beta$尽量地小.要降低$\beta$一般要增大样本容量.当$H_0$不真时,参数值越接近真值,$\beta$越大.
2. 备注假设可以是单侧，也可以双侧。
3. $H_0与H_1$地位应平等,但在控制犯第一类错误的概率$\alpha$的原则下,使得采取拒绝$H_0$ 的决策变得较慎重,即$H_0$得到特别的保护.因而,通常把有把握的、有经验的结论作为原假设,或者尽可能使后果严重的错误成为第一类错误.

###### 假设检验步骤:

$$
\begin{align*}
&1.根据实际问题所关心的内容,建立H_0与H_1在H_0为真时,选择合适的统计量V,由H_1确定拒绝域形式 \\
&给定显著性水平\alpha,其对应的拒绝域 \\
&\begin{cases}
	双侧检验\left(V < V_{1-\frac{\alpha}{2}} \cup V > V_{\frac{\alpha}{2}}\right) \\
 	左侧检验\left(V < V_{1-\alpha}\right) \\
    右侧检验\left(V > V_\alpha\right)
\end{cases}
\qquad \qquad \qquad \qquad 其中P\left(V > V_\alpha\right) = \alpha \\
&2.根据子样值计算,并作出相应的判断.
\end{align*} \qquad \qquad \qquad \qquad\qquad \qquad \qquad \qquad
$$

#### 3.2检验母体平均数

##### 一个正态母体

###### u检验法($\sigma_0^2$已知)

| 原假设$H_0$      | 备注假设$H_1$    | 检验统计量及其$H_0$为真时的分布                              | 拒绝域                                |
| ---------------- | ---------------- | ------------------------------------------------------------ | ------------------------------------- |
| $\mu = \mu_0$    | $\mu \neq \mu_0$ | $U = \frac{\bar X - \mu_0}{\frac{\sigma_0}{\sqrt{n}}} \sim N(0,1)$ | \|U\| $\geq$ $\mu_{\frac{\alpha}{2}}$ |
| $\mu \geq \mu_0$ | $\mu < \mu_0$    | $U = \frac{\bar X - \mu_0}{\frac{\sigma_0}{\sqrt{n}}} \sim N(0,1)$ | U $\leq -\mu_\alpha$                  |
| $\mu \leq \mu_0$ | $\mu > \mu_0$    | $U = \frac{\bar X - \mu_0}{\frac{\sigma_0}{\sqrt{n}}} \sim N(0,1)$ | $U \geq \mu_\alpha$                   |

###### t检验法($\sigma^2$未知)

下表中$S^{*2} = \frac{1}{n-1}\sum_{i=1}^n\left(X_i - \bar X \right)^2$

| 原假设$H_0$      | 备注假设$H_1$    | 检验统计量及其$H_0$为真时的分布                              | 拒绝域                              |
| ---------------- | ---------------- | ------------------------------------------------------------ | ----------------------------------- |
| $\mu = \mu_0$    | $\mu \neq \mu_0$ | $T = \frac{\bar X - \mu_0}{\frac{S^*}{\sqrt{n}}} \sim t(n-1)$ | \|T\| $\geq$ $t_{\frac{\alpha}{2}}$ |
| $\mu \geq \mu_0$ | $\mu < \mu_0$    | $T = \frac{\bar X - \mu_0}{\frac{S^*}{\sqrt{n}}} \sim t(n-1)$ | T $\leq -t_\alpha$                  |
| $\mu \leq \mu_0$ | $\mu > \mu_0$    | $T = \frac{\bar X - \mu_0}{\frac{S^*}{\sqrt{n}}} \sim t(n-1)$ | $T \geq t_\alpha$                   |

###### u检验法（大子样）

| 原假设$H_0$      | 备注假设$H_1$    | 检验统计量及其$H_0$为真时的分布                             | 拒绝域                                |
| ---------------- | ---------------- | ----------------------------------------------------------- | ------------------------------------- |
| $\mu = \mu_0$    | $\mu \neq \mu_0$ | $U = \frac{\bar X - \mu_0}{\frac{S}{\sqrt{n}}} \sim N(0,1)$ | \|U\| $\geq$ $\mu_{\frac{\alpha}{2}}$ |
| $\mu \geq \mu_0$ | $\mu < \mu_0$    | $U = \frac{\bar X - \mu_0}{\frac{S}{\sqrt{n}}} \sim N(0,1)$ | U $\leq -\mu_\alpha$                  |
| $\mu \leq \mu_0$ | $\mu > \mu_0$    | $U = \frac{\bar X - \mu_0}{\frac{S}{\sqrt{n}}} \sim N(0,1)$ | $U \geq \mu_\alpha$                   |

##### 两个正态母体

###### 两均值的t检验($\sigma_0^2,\sigma_1^2未知，但\sigma_0^2 = \sigma_1^2$)

| 原假设$H_0$      | 备注假设$H_1$    | 检验统计量及其$H_0$为真时的分布                              | 拒绝域                              |
| ---------------- | ---------------- | ------------------------------------------------------------ | ----------------------------------- |
| $\mu = \mu_0$    | $\mu \neq \mu_0$ | $T = \frac{\bar X - \bar Y}{S_w\sqrt{\frac{1}{n}+\frac{1}{m}}} \sim t(n+m-2) \\  S_w = \sqrt{\frac{(n-1)S_1^{*2}+(m-1)S_2^{*2}}{n+m-2}}$ | \|T\| $\geq$ $t_{\frac{\alpha}{2}}$ |
| $\mu \geq \mu_0$ | $\mu < \mu_0$    | $T = \frac{\bar X - \bar Y}{S_w\sqrt{\frac{1}{n}+\frac{1}{m}}} \sim t(n+m-2) \\  S_w = \sqrt{\frac{(n-1)S_1^{*2}+(m-1)S_2^{*2}}{n+m-2}}$ | T $\leq -t_\alpha$                  |
| $\mu \leq \mu_0$ | $\mu > \mu_0$    | $T = \frac{\bar X - \bar Y}{S_w\sqrt{\frac{1}{n}+\frac{1}{m}}} \sim t(n+m-2) \\  S_w = \sqrt{\frac{(n-1)S_1^{*2}+(m-1)S_2^{*2}}{n+m-2}}$ | $T \geq t_\alpha$                   |

###### 两均值u检验(大子样)

| 原假设$H_0$      | 备注假设$H_1$    | 检验统计量及其$H_0$为真时的分布                              | 拒绝域                                |
| ---------------- | ---------------- | ------------------------------------------------------------ | ------------------------------------- |
| $\mu = \mu_0$    | $\mu \neq \mu_0$ | $U = \frac{\bar X - \bar Y}{\sqrt{\frac{S_1^2}{n}+\frac{S_2^2}{m}}} \sim N(0,1)$ | \|U\| $\geq$ $\mu_{\frac{\alpha}{2}}$ |
| $\mu \geq \mu_0$ | $\mu < \mu_0$    | $U = \frac{\bar X - \bar Y}{\sqrt{\frac{S_1^2}{n}+\frac{S_2^2}{m}}} \sim N(0,1)$ | U $\leq -\mu_\alpha$                  |
| $\mu \leq \mu_0$ | $\mu > \mu_0$    | $U = \frac{\bar X - \bar Y}{\sqrt{\frac{S_1^2}{n}+\frac{S_2^2}{m}}} \sim N(0,1)$ | $U \geq \mu_\alpha$                   |

#### 3.3检验母体方差

##### 一个正态母体

设母体$X \sim N(\mu,\sigma^2)$,作假设$H_0: \sigma^2 = \sigma_0^2$。常用于方差检验的统计量为如下两个:
$$
\chi^2 = \frac{\sum_{i=1}^n\left(X_i - \mu\right)^2}{\sigma_0^2} \sim \chi^2(n) \\
\chi^2 = \frac{(n-1)S^{*2}}{\sigma_0^2} \sim \chi^2(n-1)
$$

###### $\chi^2$检验法($\mu$已知)

| 原假设$H_0$                | 备注假设$H_1$              | 检验统计量及其$H_0$为真时的分布                              | 拒绝域                                                       |
| -------------------------- | -------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| $\sigma^2=\sigma^2_0$      | $\sigma^2 \neq \sigma^2_0$ | $\chi^2 = \frac{\sum_{i=1}^n(X_i - \mu)^2}{\sigma_0^2} \sim \chi^2(n) \qquad  (\mu已知)$ | $\chi^2 \leq \chi^2_{1-\frac{\alpha}{2}}(n) 或 \chi^2 \geq \chi^2_{\frac{\alpha}{2}}(n)$ |
| $\sigma^2 \geq \sigma_0^2$ | $\sigma^2 < \sigma_0^2$    | $\chi^2 = \frac{\sum_{i=1}^n(X_i - \mu)^2}{\sigma_0^2} \sim \chi^2(n) \qquad  (\mu已知)$ | $\chi^2 \leq \chi^2_{1-\frac{\alpha}{2}}(n)$                 |
| $\sigma^2 \leq \sigma_0^2$ | $\sigma > \sigma_0^2$      | $\chi^2 = \frac{\sum_{i=1}^n(X_i - \mu)^2}{\sigma_0^2} \sim \chi^2(n) \qquad  (\mu已知)$ | $\chi^2 \geq \chi^2_{\frac{\alpha}{2}}(n)$                   |

###### $\chi^2$检验法($\mu$ 未知)

其中下表中$S^{*2} = \frac{1}{n-1}\sum_{i=1}^n(X_i - \bar X)^2$

| 原假设$H_0$                | 备注假设$H_1$              | 检验统计量及其$H_0$为真时的分布                              | 拒绝域                                                       |
| -------------------------- | -------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| $\sigma^2=\sigma^2_0$      | $\sigma^2 \neq \sigma^2_0$ | $\chi^2 = \frac{(n-1)S^{*2}}{\sigma_0^2} \sim \chi^2(n-1) \qquad (\mu未知)$ | $\chi^2 \leq \chi^2_{1-\alpha}(n-1) 或 \chi^2 \geq \chi^2_{\alpha}(n-1)$ |
| $\sigma^2 \geq \sigma_0^2$ | $\sigma^2 < \sigma_0^2$    | $\chi^2 = \frac{(n-1)S^{*2}}{\sigma_0^2} \sim \chi^2(n-1) \qquad (\mu未知)$ | $\chi^2 \leq \chi^2_{\alpha}(n-1)$                           |
| $\sigma^2 \leq \sigma_0^2$ | $\sigma > \sigma_0^2$      | $\chi^2 = \frac{(n-1)S^{*2}}{\sigma_0^2} \sim \chi^2(n-1) \qquad (\mu未知)$ | $\chi^2 \geq \chi^2_{\alpha}(n-1)$                           |

###### u检验法(大子样)

设$\chi^2 \sim \chi^2(n)$，当n较大时有$\frac{\chi^2 - n}{\sqrt{2n}} \sim N(0,1)$(中心极限定理)  $\Longrightarrow U = \frac{\frac{(n-1)S^{*2}}{\sigma^2}-(n-1)}{\sqrt{2(n-1)}} \sim N(0,1)$

| 原假设$H_0$                 | 备注假设$H_1$              | 检验统计量及其$H_0$为真时的分布                              | 拒绝域                            |
| --------------------------- | -------------------------- | ------------------------------------------------------------ | --------------------------------- |
| $\sigma^2=\sigma^2_0$       | $\sigma^2 \neq \sigma^2_0$ | $U = \frac{\chi^2 - (n-1)}{\sqrt{2(n-1)}} \sim N(0,1) \\其中\chi^2 = \frac{(n-1)S^{}}{\sigma_0^2}$ | $|U| \geq \mu_{\frac{\alpha}{2}}$ |
| $\sigma^2 \geq \sigma_0^2$  | $\sigma^2 < \sigma_0^2$    | $U = \frac{\chi^2 - (n-1)}{\sqrt{2(n-1)}} \sim N(0,1) \\其中\chi^2 = \frac{(n-1)S^{}}{\sigma_0^2}$ | $U \leq -\mu_{\alpha}$            |
| $\sigma^2  \leq \sigma_0^2$ | $\sigma^2 > \sigma_0^2$    | $U = \frac{\chi^2 - (n-1)}{\sqrt{2(n-1)}} \sim N(0,1) \\其中\chi^2 = \frac{(n-1)S^{}}{\sigma_0^2}$ | $U \geq \mu_{\alpha}$             |

##### 两个正态母体

设母体$X \sim N(\mu_1,\sigma^2_1), Y \sim N(\mu_2,\sigma_2^2), \left(X_1,X_2,\cdots,X_n\right)与\left(Y_1,Y_2,\cdots,Y_m\right)$独立，作假设 $H_0:\sigma_1^2 = \sigma_2^2;H_1:\sigma_1^2 \neq \sigma_2^2$。当$H_0$成立时，由抽样分布的重要结论有$F = \frac{\frac{S_1^{*2}}{\sigma_1^2}}{\frac{S_2^{*2}}{\sigma_2^2}} = \frac{S_1^{*2}}{S_2^{*2}} \sim F(n-1,m-1)$

###### F检验法

| 原假设$H_0$                  | 备注假设$H_1$                | 检验统计量及其$H_0$为真时的分布                              | 拒绝域                                                       |
| ---------------------------- | ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| $\sigma_1^2=\sigma^2_2$      | $\sigma_1^2 \neq \sigma_2^2$ | $F = \frac{S_1^{*2}}{S_2^{*2}} \sim F(n-1,m-1) \qquad \\ \mu_1,\mu_2均未知$ | $F \leq F_{1-\frac{\alpha}{2}}(n-1,m-1) 或 F \geq F_{\frac{\alpha}{2}}(n-1,m-1)$ |
| $\sigma_1^2 \geq \sigma_2^2$ | $\sigma_1^2 < \sigma_2^2$    | $F = \frac{S_1^{*2}}{S_2^{*2}} \sim F(n-1,m-1) \qquad \\ \mu_1,\mu_2均未知$ | $F \leq F_{1-\alpha}(n-1.m-1)$                               |
| $\sigma_1^2 \leq \sigma_2$   | $\sigma_1^2 > \sigma_2^2$    | $F = \frac{S_1^{*2}}{S_2^{*2}} \sim F(n-1,m-1) \qquad \\ \mu_1,\mu_2均未知$ | $F \geq F_{\alpha}(n-1,m-1)$                                 |

#### 3.4单侧假设检验

遇到假设$H_0$的形式为$\mu \leq \mu_0,\mu \geq \mu_0 ,\sigma^2 \leq \sigma_0^2 ,\mu_1 \leq \mu_2 ,\sigma_1^2 \leq \sigma_2^2$等，此时假设$H_0$可称为原假设或零假设；它的对立情形，称为备择假设或对立假设，记为$H_1$.由$H_0$与相对应的​H_1构成的一对假设，称为**单侧假设**。

由于假设检验是控制犯第一类错误的概率,使得拒绝原假设$H_0$的决策变得比较慎重, 也就是$H_0$得到特别的保护.因而,  通常把有把握的,  经验的结论作为原假设,   或者尽量使后果严重的错误成为第一类错误.

![image-20210118120500645](C:\Users\Ally\AppData\Roaming\Typora\typora-user-images\image-20210118120500645.png)

![image-20210118120754189](C:\Users\Ally\AppData\Roaming\Typora\typora-user-images\image-20210118120754189.png)

![image-20210118120816095](C:\Users\Ally\AppData\Roaming\Typora\typora-user-images\image-20210118120816095.png)

![image-20210118120858452](C:\Users\Ally\AppData\Roaming\Typora\typora-user-images\image-20210118120858452.png)

##### 单侧参数假设检验

###### 一个母体

正态母体($\sigma_0^2$已知)

| 原假设$H_0$      | 备注假设$H_1$    | 所用统计量及其分布                                           | 拒绝区域                                                     |
| ---------------- | ---------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| $\mu = \mu_0$    | $\mu \neq \mu_0$ | $U=\frac{\bar X - \mu_0}{\frac{\sigma_0}{\sqrt{n}}} \sim N(0,1)$ | $|\bar x - \mu_0| \geq u_{\frac{\alpha}{2}}\frac{\sigma_0}{\sqrt{n}}$ |
| $\mu \le \mu_0 $ | $\mu > \mu_0$    | $U=\frac{\bar X - \mu_0}{\frac{\sigma_0}{\sqrt{n}}} \sim N(0,1)$ | $\bar x - \mu_0 \ge \mu_{\alpha}\frac{\sigma_0}{\sqrt{n}}$   |
| $\mu \ge \mu_0$  | $\mu < \mu_0$    | $U=\frac{\bar X - \mu_0}{\frac{\sigma_0}{\sqrt{n}}} \sim N(0,1)$ | $\bar x -\mu_0 \le -\mu_{\alpha}\frac{\sigma_0}{\sqrt{n}}$   |

正态母体($\sigma^2_0$未知)

| 原假设$H_0$      | 备注假设$H_1$    | 所用统计量及其分布                                          | 拒绝区域                                                     |
| ---------------- | ---------------- | ----------------------------------------------------------- | ------------------------------------------------------------ |
| $\mu = \mu_0$    | $\mu \neq \mu_0$ | $T=\frac{\bar X - \mu_0}{\frac{S^*}{\sqrt{n}}} \sim t(n-1)$ | $|\bar x - \mu_0| \ge t_{\frac{\alpha}{2}}{\frac{S^*}{\sqrt{n}}}$ |
| $\mu \le \mu_0 $ | $\mu > \mu_0$    | $T=\frac{\bar X - \mu_0}{\frac{S^*}{\sqrt{n}}} \sim t(n-1)$ | $\bar x - \mu_0 \ge t_{\alpha}(n-1)\frac{S^*}{\sqrt{n}}$     |
| $\mu \ge \mu_0$  | $\mu < \mu_0$    | $T=\frac{\bar X - \mu_0}{\frac{S^*}{\sqrt{n}}} \sim t(n-1)$ | $\bar x - \mu_0 \leq -t_{\alpha}(n-1)\frac{S^*}{\sqrt{n}}$   |

大子样($\sigma_0^2$未知)

| 原假设$H_0$      | 备注假设$H_1$    | 所用统计量及其分布                                          | 拒绝区域                                                     |
| ---------------- | ---------------- | ----------------------------------------------------------- | ------------------------------------------------------------ |
| $\mu = \mu_0$    | $\mu \neq \mu_0$ | $U = \frac{\bar X - \mu_0}{\frac{S}{\sqrt{n}}} \sim N(0,1)$ | $|\bar x - \mu_0| \geq u_{\frac{\alpha}{2}}\frac{S}{\sqrt{n}}$ |
| $\mu \le \mu_0 $ | $\mu > \mu_0$    | $U = \frac{\bar X - \mu_0}{\frac{S}{\sqrt{n}}} \sim N(0,1)$ | $\bar x - \mu_0 \ge \mu_{\alpha}\frac{S}{\sqrt{n}}$          |
| $\mu \ge \mu_0$  | $\mu < \mu_0$    | $U = \frac{\bar X - \mu_0}{\frac{S}{\sqrt{n}}} \sim N(0,1)$ | $\bar x -\mu_0 \le -\mu_{\alpha}\frac{S}{\sqrt{n}}$          |

正态母体(方差检验)

| 原假设$H_0$               | 备注假设$H_1$              | 所用统计量及其分布                                       | 拒绝区域                                                     |
| ------------------------- | -------------------------- | -------------------------------------------------------- | ------------------------------------------------------------ |
| $\sigma^2 = \sigma_0^2$   | $\sigma^2 \neq \sigma_0^2$ | $\chi^2=(n-1)\frac{S^{*2}}{\sigma_0^2} \sim \chi^2(n-1)$ | $(n-1)\frac{S^{*2}}{\sigma^2_0} \ge \chi^2_{\frac{\alpha}{2}}(n-1)$或$(n-1)\frac{S^{*2}}{\sigma^2_0} \le \chi^2_{\frac{\alpha}{2}}(n-1)$ |
| $\sigma^2 \le \sigma_0^2$ | $\sigma^2 > \sigma_0^2$    | $\chi^2=(n-1)\frac{S^{*2}}{\sigma_0^2} \sim \chi^2(n-1)$ | $(n-1)\frac{S^{*2}}{\sigma^2_0} \ge \chi^2_{\frac{\alpha}{2}}(n-1)$ |
| $\sigma^2 \ge \sigma^2_0$ | $\sigma^2 < \sigma_0^2$    | $\chi^2=(n-1)\frac{S^{*2}}{\sigma_0^2} \sim \chi^2(n-1)$ | $(n-1)\frac{S^{*2}}{\sigma^2_0} \le \chi^2_{\frac{\alpha}{2}}(n-1)$ |

###### 两个母体

两个正态母体($\sigma_1^2 = \sigma^2_2,但方差未知$)

下表中$S_w = \sqrt{\frac{(n_1-1)S_1^{*2}+(n_2-1)S_2^{*2}}{n_1+n_2-2}}$

| 原假设$H_0$       | 备注假设$H_1$      | 所用统计量及其分布                                           | 拒绝区域                                                     |
| ----------------- | ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| $\mu_1 = \mu_2$   | $\mu_1 \neq \mu_2$ | $T = \frac{\bar X_1 - \bar X_2}{S_w\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}} \sim t(n_1+n_2-2) $ | $|\bar x_1 - \bar x_2| \ge t_{\frac{\alpha}{2}}(n_1+n_2-2)\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}S_w$ |
| $\mu_1 \le \mu_2$ | $\mu_1 > \mu_2$    | $T = \frac{\bar X_1 - \bar X_2}{S_w\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}} \sim t(n_1+n_2-2) \\  $ | $\bar x_1 - \bar x_2 \ge t_{\frac{\alpha}{2}}(n_1+n_2-2)\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}S_w$ |
| $\mu_1 \ge \mu_2$ | $\mu_1 < \mu_2$    | $T = \frac{\bar X_1 - \bar X_2}{S_w\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}} \sim t(n_1+n_2-2) $ | $|\bar x_1 - \bar x_2| \le t_{\frac{\alpha}{2}}(n_1+n_2-2)\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}S_w$ |

大子样

| 原假设$H_0$       | 备注假设$H_1$      | 所用统计量及其分布                                           | 拒绝区域                                                     |
| ----------------- | ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| $\mu_1 = \mu_2$   | $\mu_1 \neq \mu_2$ | $U = \frac{\bar X_1 - \bar X_2}{\sqrt{\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2}}} \sim N(0,1)$ | $|\bar x_1 - \bar x_2| \ge \mu_{\frac{\alpha}{2}}\sqrt{\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2}}$ |
| $\mu_1 \le \mu_2$ | $\mu_1 > \mu_2$    | $U = \frac{\bar X_1 - \bar X_2}{\sqrt{\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2}}} \sim N(0,1)$ | $\bar x_1 - \bar x_2 \ge \mu_{\frac{\alpha}{2}}\sqrt{\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2}}$ |
| $\mu_1 \ge \mu_2$ | $\mu_1 < \mu_2$    | $U = \frac{\bar X_1 - \bar X_2}{\sqrt{\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2}}} \sim N(0,1)$ | $\bar x_1 - \bar x_2 \ge \mu_{\frac{\alpha}{2}}\sqrt{\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2}}$ |

两个正态母体

| 原假设$H_0$                 | 备注假设$H_1$                | 所用统计量及其分布                                  | 拒绝区域                                                     |
| --------------------------- | ---------------------------- | --------------------------------------------------- | ------------------------------------------------------------ |
| $\sigma_1^2=\sigma^2_2$     | $\sigma_1^2 \neq \sigma^2_2$ | $F = \frac{S_1^{*2}}{S_2^{*2}} \sim F(n_1-1,n_2-1)$ | $\frac{S_1^{*2}}{S_2^{*2}} \leq F_{1-\frac{\alpha}{2}}(n_1-1,n_2-1) 或 \frac{S_1^{*2}}{S_2^{*2}} \geq F_{\frac{\alpha}{2}}(n_1-1,n_2-1)$ |
| $\sigma_1^2 \le \sigma^2_2$ | $\sigma_1^2 > \sigma^2_2$    | $F = \frac{S_1^{*2}}{S_2^{*2}} \sim F(n_1-1,n_2-1)$ | $\frac{S_1^{*2}}{S_2^{*2}} \geq F_{\alpha}(n_1-1,n_2-1)$     |
| $\sigma_1^2 \ge \sigma^2_2$ | $\sigma_1^2 < \sigma^2_2$    | $F = \frac{S_1^{*2}}{S_2^{*2}} \sim F(n_1-1,n_2-1)$ | $\frac{S_1^{*2}}{S_2^{*2}} \leq F_{1-\alpha}(n_1-1,n_2-1)$   |

$$
\begin{align*}
&2018年期末题:某统计部门对当前市场的某种食品的价格情况进行调查，根据某市20个集市上的抽查结果，该食品的平均售价为3.4（元/斤），\\&标准差为0.27（元/斤）.按照往年经验，该食品价格X服从正态分布，其平均售价一直稳定在3.25（元/斤）左右，问该食品当前的市场价是否\\&不高于往年（提示:\alpha = 0.05,t_{0.95}(19)=1.729）？\\
&解:欲检验假设H_0 : \mu \leq \mu_0=3.25,H_1:\mu>\mu_0=3.25 \\
&由题意可得X \sim N(3.25,\sigma^2),可使得检验统计量T=\frac{\bar X - \mu_0}{S}\sqrt{n} \sim t(n-1),\\&当\alpha=0.05时，查表得t_{1-\alpha}(n-1)=t_{0.95}(19)=1.729,其拒绝域为 \\
&	\qquad\qquad K_0 = \{t > t_{1-\alpha}(n-1)\} = \{t > t_{0.95}(19) = 1.729\} \\
&由于n=20，\bar X=3.4，s=0.27.可得t=\frac{\bar X - \mu_0}{S}\sqrt{n}=\frac{3.4-3.25}{0.27}\sqrt{20}=2.48 > 1.729，\\
&所以t \in K_0,所有拒绝H_0,接受H_1，即认为市场当前的食品售价是明显高于往年.
\end{align*}
$$

#### 3.5分布假设检验

对母体分布作某假设用母体的一个子样来检验该假设是否成立，称为分布假设检验，也被称为拟合优度检验—检验观察到的一批数据是否与某种理论分布符合。
$$
\begin{cases}
假设母体分布已知\qquad  H_0:F(x)=F_0(x) \rightarrow 一个分布函数  例如H_0:f(x) = \frac{e^{-\frac{x^2}{2}}}{\sqrt{2 \pi}} \\

母体分布类型已知，参数未知 \qquad H_0:F(x)=F_0(x,\theta) \rightarrow 一族分布函数 例如H_0: X \sim P(\lambda),\lambda未知
\end{cases} \qquad \qquad \qquad \qquad \qquad \qquad 
$$

$$
\begin{align*}
&怎样使提出的尽可能F_0(x,\theta)尽可能符合母体分布函数F(x)？ \\
&方法\begin{cases}
		1.通过子样观察值作出经验分布函数F_n(x) \\
        2.借助常用概率分布的物理模型
	\end{cases}  \qquad\Longrightarrow 推测F_0(x,\theta)
\end{align*}  \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad
$$

具体方法：

1. 正态概率纸法—检验母体是否正态母体. 
2. $\chi^2$检验法—适应范围较广

###### $\chi^2$检验法

皮尔逊定理:当n充分大时,不论母体是什么分布,统计量

​							$\chi^2 = \sum_{i=1}^l \frac{(m_i-np_i)^2}{np_i} \sim \chi^2(l-k-1)$

其中k为被估参数个数。

$\chi^2$检查的方法步骤:

1. 作假设$H_0:F(x)=F_0(x,\theta_1,\cdots,\theta_k),$若$\theta_j$未知，则用$\left(\hat \theta_j\right)_{mle}(j=1 \sim k)$代替

2. 将子样分成l 个互不相交的区间$(a_{i-1},a_i],i=1,2,\cdots,l$  计算$p_i = F(a_i) - F(a_{i-1}),i=1,2,\cdots,l$  

   ​     $\chi^2 = \sum_{i=1}^l \frac{(m_i-np_i)^2}{np_i}$

3. 作判断。若$\chi^2 > \chi^2_{\alpha}(l-k-1)$,则在水平$\alpha$下拒绝$H_0$;反之接受$H_0$

###### $\chi^2$检验的一般要求

- 样本容量$n \ge 50$
- 理论频数$np_i \ge 5$,否则适当合并区间，使$np_i$满足要求。

### 第四章 方差分析、正交试验设计

通常把生产实践与科学实验中的结果，如产品的性能，产量等统称为指标，影响指标的因素用A，B，C，$\cdots$，表示因素在试验中所取的不同状态称为水平，因素A的不同水平用$A_1,A_2,\cdots$表示。

在一项试验中，如果让一个因素的水平变化，其他因素水平保持不变，这样的试验叫做单因素试验。处理单因素试验的统计推断问题称为单因素方差分析或一元方差分析。类似地可定义多因素方差分析。

#### 4.1一元方差分析

一元方差分析:用于考察某因素(多水平)对试验结果有无显著影响。

因子:影响试验结果的因素。

水平:因子的状态。

##### 数学模型

设在一项试验中，因素A有r个不同水平$A_1,A_2,\cdots,A_r$，在
水平$A_i$下的试验结果$X_i$服从正态分布$N(\mu,\sigma^2)(i=1,2,\cdots,r),$且$X_1,\cdots,X_r$相互独立。现在水平$A_i$下做了$n_i$次试验，获得了$n_i$个试验结果$X_{ij}(j=1,2,3,\cdots,n_i)$,它可以看成是取自总体$X_i（i=1,2,\cdots,r）$的一个样本。由于$X_{ij}$服从正态分布$N(\mu_i,\sigma^2)$,故$X_{ij}$与$\mu_i$的差可以看成一个随机误差$\xi,\xi_{ij}$服从正态分布(i=1,2,$\cdots$,j=1,2,$\cdots,n_i$)。于是单因素方差分析的数学模型可以表示为 
$$
\begin{cases}
	X_{ij} = \mu_i + \xi_{ij} \\
	\xi_{ij} \sim N(0,\sigma^2) 
\end{cases} \\
i=1,2,\cdots,r, j=1,2,\cdots,n_i \\
\begin{align*}
&其中诸\xi_{ij}相互独立。检验上述同方差的r个正态总体的均值是否相等，即检验假设：\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\\
&\qquad\qquad\qquad\qquad	H_0 = \mu_1 = \mu_2 = \cdots = \mu_r \qquad \leftrightarrow \qquad H_1:\mu_1,\mu_2,\cdots,\mu_r 中至少有两个不相等
\end{align*}
$$
检验假设$H_0$可以通过离差平方和分离方法。
$$
\begin{align*}
&组内平均:\bar X_i = \frac{1}{n_i}\sum_{j=1}^{n_i}X_{ij},\qquad i=1,2,\cdots,r \qquad \left(1\right)\\
&总平均:\bar X = \frac{1}{n}\sum_{i=1}^r\sum_{j=1}^{n_i}X_{ij}=\frac{1}{n}\sum_{i=1}^r\bar X_in_i \qquad \left(2\right)\\
&其中n=\sum_{i=1}^r,\bar X_i是从第 i个总体中抽得的样本均
值，称为组内平均，而\bar X称为总平均，n是从r个总体中抽得的样本的总容量。\\
&有上两公式可得:	\sum_{i=1}^r\sum_{j=1}^{n_i}(X_{ij} - \bar X_i)(\bar X_i - \bar X) = 0 \\
&总离差平方和: Q_r=\sum_{i=1}^r\sum_{j=1}^{n_i}(X_{ij}-\bar X)^2=\sum_{i=1}^r\sum_{j=1}^{n_i}[(X_{ij}-\bar X_i)+(\bar X_i - \bar X)]^2 \\
&\qquad \qquad \qquad \quad =\sum_{i=1}^r\sum_{j=1}^{n_i}(X_{ij}-\bar X_i)^2+2\sum_{i=1}^r\sum_{j=1}^{n_i}(X_{ij} - \bar X_i)(\bar X_i - \bar X)+\sum_{i=1}^r\sum_{j=1}^{n_i}(\bar X_i - \bar X)^2 \\
&\qquad \qquad \qquad \quad =\sum_{i=1}^r\sum_{j=1}^{n_i}(X_{ij}-\bar X_i)^2 +\sum_{i=1}^r\sum_{j=1}^{n_i}(\bar X_i - \bar X)^2 \\
&\qquad \qquad \qquad \quad令: Q_{E} = \sum_{i=1}^r\sum_{j=1}^{n_i}(X_{ij}-\bar X_i)^2 \\
&\qquad\qquad \qquad  \quad Q_{A} = \sum_{i=1}^rn_i(\bar X_i - \bar X)^2 \\
&\qquad \qquad \qquad \quad分别称Q_{E}与Q_{A}为组内离差平方和与组间离差平方和。Q_{E}表示X_{ij}与其组内平均X_{i}的离差平方和，\\&\qquad \qquad \qquad \quad它反映了试验误差引起的数据波动，而第二项Q_{A}是组内平均与总平均的
离差平方和，它在一定程度上\\&\qquad \qquad \qquad \quad反映了因素水平的改变引起的数据波动和试验误差引起的数据波动，从而得 \\
&\qquad \qquad \qquad \qquad \qquad\quad Q_{T}=Q_{E} + Q_{A} \\
&\qquad \qquad \qquad \quad上式称为总离差平方和分解公式

\end{align*}
$$

##### 方差分析表

| 来源 | 离差平方和                                                | 自由度 | 均方离差                  | F值                     |
| ---- | --------------------------------------------------------- | ------ | ------------------------- | ----------------------- |
| 组间 | $Q_A = \sum_{i=1}^rn_i(\bar X_i - \bar X)^2$              | r-1    | $S_A^2 = \frac{Q_A}{r-1}$ | $F=\frac{S_A^2}{S_E^2}$ |
| 组内 | $Q_E = \sum_{i=1}^r\sum_{j=1}^{n_r}(X_{ij}-\bar X_{i})^2$ | n-r    | $S_E^2 =\frac{Q_E}{n-r}$  |                         |
| 总和 | $Q_T = \sum_{i=1}^r\sum_{j=1}^{n_r}(X_{ij}-\bar X)^2$     | n-1    |                           |                         |

如果$F \ge F_{\alpha}(r-1,n-r)$,则拒绝$H_0$,认为因素对实验结果有显著影响

如果$F < F_{\alpha}(r-1,n-r)$,则接受$H_0$,认为因素对实验结果无显著影响

![image-20210120140607217](D:\Typora截图\image-20210120140607217.png)

![image-20210120140625981](D:\Typora截图\image-20210120140625981.png)

![image-20210120141348631](D:\Typora截图\image-20210120141348631.png)

#### 4.2二元方差分析

二元方差分析是二个因素对试验结果的影响是否显著。分为非重复试验和重复试验

##### 非重复试验二元方差分析

设有两个因素A,B,因素A有r个不同水平:$A_1,A_2,\cdots,A_r$;因素B有s个不同水平:$B_1,B_2,\cdots,B_s$,在A,B的每一种组合水平$(A_i,B_j)$下作一次试验，试验结果为$X_{ij}(i=1,\cdots,r,j=1,\cdots,s)$，所有$X_{ij}$相互独立,共得rs个试验结果。如下表:

![image-20210120142504790](D:\Typora截图\image-20210120142504790.png)

假定总体$X_{ij}$服从正态分布$N(\mu_{ij},\sigma^2)$其中  	 $\mu_{ij}=\mu+\alpha_i+\beta_j,\qquad i=1,2,\cdots,r,j=1,2,\cdots,s$

而$\sum_{i=1}^r a_i = 0,\sum_{j=1}^s\beta_j = 0$于是$X_{ij}$可表示为
$\begin{cases} X_{ij} = \mu+\alpha_i+\beta_j+\xi_{ij}, \qquad i=1,2,\cdots,r;j=1,2,\cdots,s, \\ \xi_{ij} \sim N(0,\sigma^2) \end{cases}$
其中诸$\xi_{ij}$相互独立，$\alpha_i$称为因素 A在水平$A_i$引起的效应，它表示水平$A_i$在总体平均数上引起的偏差。同样,$\beta_j$称为因素B在水平$B_j$引起的效应，它表示水平$B_j$在总体平均数上引起的偏差。

所以要推断因素A的影响是否显著，就等价于要检验假设

​	$H_{01}: \alpha_1=\alpha_2=\cdots=0 \leftrightarrow H_{11}:$至少有一个 $\alpha_i \ne 0,i=1,2,\cdots,r$.

类似地，要推断因素B的影响是否显著，就等价于要检验假设

   $H_{02}: \beta_1=\beta_2=\cdots=\beta_s=0 \leftrightarrow H_{12}:$至少有一个 $\beta_j \ne 0,j=1,\cdots,s$

###### 方差分析表

| 来源  |                          离差平方和                          |   自由度   |            均方离差            |            F值            |
| :---: | :----------------------------------------------------------: | :--------: | :----------------------------: | :-----------------------: |
| 因子A |       $Q_A = s\sum_{i=1}^{r}(\bar X_{i.} - \bar X)^2$        |    r-1     |   $S_A^2 = \frac{Q_A}{r-1}$    | $F_A=\frac{S_A^2}{S_E^2}$ |
| 因子B |          $Q_B=r\sum_{j=1}^s(\bar X_{.j} - \bar X)$           |    s-1     |    $S_B^2=\frac{Q_B}{s-1}$     | $F_B=\frac{S_B^2}{S_E^2}$ |
| 误差  | $Q_E=\sum_{i=1}^r\sum_{j=1}^s(X_{ij}-\bar X_{i.}-\bar X_{.j}+\bar X)$ | (r-1)(s-1) | $S_E^2=\frac{Q_E}{(r-1)(s-1)}$ |                           |
| 总和  |     $Q_T=\sum_{i=1}^r\sum_{j=1}^s(\bar X_{ij}-\bar X)^2$     |    rs-1    |                                |                           |

$F_A \ge F_{\alpha}(r-1,(r-1)(s-1))$则拒绝$H_{01}$,认为因素A对实验结果有显著影响

$F_A < F_{\alpha}(r-1,(r-1)(s-1))$则接受$H_{01}$,认为因素A对实验结果无显著影响

$F_B \ge F_{\alpha}(s-1,(r-1)(s-1))$则拒绝$H_{02}$,认为因素B对实验结果有显著影响

$F_B < F_{\alpha}(s-1,(r-1)(s-1))$则接受$H_{02}$,认为因素B对实验结果无显著影响

##### 重复试验二元方差分析

在以上的讨论中，由于只对A，B两个因素的每一种组合水平进行了一次试验，所以不能分析A，B两因素间是否存在交互作用的影响。下面讨论在每一种组合水平下$(A_i,B_j)$等重复试验情形的方差分析问题。

设有两个因素A和B，因素A有r个不同水平$A_1,A_2,\cdots,A_r$,因素B有s个不同水平$B_1,B_2,\cdots,B_s$，在每一种组合水平$(A_i,B_j)$下重复试验t次，测得试验数据为$X_{ijk}(i=1,2,\cdots,r,j=1,2,\cdots,s,k=1,2,\cdots,t)$将它们列成表.

![image-20210120153521128](D:\Typora截图\image-20210120153521128.png)

![image-20210120153705732](D:\Typora截图\image-20210120153705732.png)

![image-20210120153721910](D:\Typora截图\image-20210120153721910.png)

![image-20210120153740539](D:\Typora截图\image-20210120153740539.png)

![image-20210120153802919](D:\Typora截图\image-20210120153802919.png)

![image-20210120153824998](D:\Typora截图\image-20210120153824998.png)

###### 方差分析表

|   来源    |                          离差平方和                          |   自由度   |            均方离差            |           F值           |
| :-------: | :----------------------------------------------------------: | :--------: | :----------------------------: | :---------------------: |
|   因子A   |         $Q_A=sc\sum_{i=1}^r(\bar X_{i..}-\bar X)^2$          |    r-1     |    $S_A^2=\frac{Q_A}{r-1}$     | $F=\frac{S_A^2}{S_E^2}$ |
|   因子B   |         $Q_B=rc\sum_{j=1}^s(\bar X_{.j.}-\bar X)^2$          |    s-1     |    $S_B^2=\frac{Q_B}{s-1}$     | $F=\frac{S_B^2}{S_E^2}$ |
| 交互作用I | $Q_I=c\sum_{i=1}^r\sum_{j=1}^s(\bar X_{ij.} - \bar X_{i..}-\bar  X{.j.}+\bar X)^2$ | (r-1)(s-1) | $S_I^2=\frac{Q_I}{(r-1)(s-1)}$ | $F=\frac{S_I^2}{S_E^2}$ |
|   误差    | $Q_E=\sum_{i=1}^r\sum_{j=1}^s\sum_{k=1}^c(X_{ijk}-\bar X_{ij.})^2$ |  rs(c-1)   |  $S_E^2=\frac{Q_E}{rs(c-1)}$   |                         |
|   总和    | $Q_T=\sum_{i=1}^r\sum_{j=1}^s\sum_{k=1}^c(X_{ijk}-\bar X)^2$ |   rsc-1    |                                |                         |

$F_A \ge F_{\alpha}(r-1,rs(c-1))$则拒绝$H_{01}$,认为因素A对实验结果有显著影响

$F_A < F_{\alpha}(r-1,rs(c-1))$则接受$H_{01}$,认为因素A对实验结果无显著影响

$F_B \ge F_{\alpha}(s-1,rs(c-1))$则拒绝$H_{02}$,认为因素B对实验结果有显著影响

$F_B < F_{\alpha}(s-1,rs(c-1))$则接受$H_{02}$,认为因素B对实验结果无显著影响

$F_I \ge F_{\alpha}((r-1)(s-1),rs(c-1))$则拒绝$H_{03}$,认为因素A,B的交互作用对实验结果有显著影响

$F_I < F_{\alpha}((r-1)(s-1),rs(c-1))$则接受$H_{03}$,认为因素A,B的交互作用对实验结果无显著影响

#### 4.3正交试验设计

正交试验设计:用部分试验代替全体试验，通过对部分试验结果的分析，了解全面试验的情况。

正交表$L_a(b^c)$:

- L：表示正交表
- a：表示做了a次试验
- b：因素的水平个数
- c：表示此表最多安排c个b水平因素

性质：

1. 任一列中，各水平都出现且出现此数相等
2. 任两列中各不同水平的所有可能组合都出现，且每对次数相同

正交表类别$\begin{cases}等水平正交表：各列水平数相同 \\混合水平正交表：各列水平数不全相同 \qquad  L_8(4X2^4) \rightarrow 1个4水平和4个2水平\end{cases}$

正交表的选择：

- 列：正交表列数 $\ge$ 因素所占列数 + 交互作用所占列数+空列
- 自由度：正交表总自由度 $\ge$ 因素自由度+交互作用自由度+误差自由度

###### 直观分析法(极差分析法)

计算$\begin{cases}k_{jm}:是第j列因素m水平所对应试验的指标和 \\ R_j:每j列因素的极差\end{cases}$

判断$\begin{cases}优水平 \\ 优组合 \\ 因素主次\end{cases}$

所有优水平的组合为优组合

$K_{A_i}$:A因素/水平标记量之和

$k_{A_i}$:A因素/水平标记量之和平均值

$R_A:max\{K_{A_i}\}-min\{K_{A_i}\}$

怎么判断优水平:$A_i \{max\{K_{A_i}\}\}$

怎么判断主次顺序:极差由高到低，由主到次

![image-20210120164209458](D:\Typora截图\image-20210120164209458.png)

![image-20210120164225995](D:\Typora截图\image-20210120164225995.png)

![image-20210120164241941](D:\Typora截图\image-20210120164241941.png)

![image-20210120164258216](D:\Typora截图\image-20210120164258216.png)

其中$K_{A_1}$=36.2+31.77+38.79+38.02=144.78

​		$k_{A_1}$=$K_{A_1}/4 = 36.195 \approx$36.20

​		$R_A=k_1-k_4$=3.87

​		因素主次顺序:由$R_A>R_C>R_B>R_D$可得A>C>B>D

​		优水平:由$k_1>k_2>k_3>k_4$可得优水平为$A_1$

​		优组合:所有优水平的组合为优组合 $\Longrightarrow A_1B_1C_4D_2$

### 第五章 回归分析

$$
内容\begin{cases}
一元线性回归\begin{cases} 参数估计 \\ 假设检验\begin{cases} 回归检验  \\ 系数检验 \end{cases} \\ 预测 \end{cases} \\
一元非线性回归 \\
多元线性回归 \begin{cases} 参数估计 \\ 假设检验\begin{cases}回归检验 \\ 系数检验  \end{cases} \\预测\end{cases} 
\end{cases} \qquad \qquad \qquad \qquad \qquad\qquad \qquad \qquad \qquad \qquad\qquad \qquad \qquad \qquad \qquad\qquad \qquad
$$

$$
变量关系\begin{cases} 确定性关系—由函数关系描述 \\ 
随机性关系 \begin{cases} 相关关系 \\ 回归关系\end{cases}\end{cases} \qquad \qquad \qquad \qquad
$$

相关与回归的区别:

回归关系:自变量是非随机的可控的，因变量是随可控变量变换的随机变量。

相关关系:两个变量都是随机变量。

回归分析:自变量可控时变量间关系的分析。

一元回归分析：只有一个自变量的回归分析。

多元回归分析：有多于一个自变量的回归分析。

#### 5.1一元线性回归中的参数估计

##### 一元线性回归模型

设x是可控变量，Y是依赖x的随机变量，两者关系式为
$$
Y = a+bx+\xi,\qquad \xi \sim N(0,\sigma^2),a,b,\sigma=const.
$$
当x取定值时，$Y \sim N(a+bx,\sigma^2)$

记$\hat y(x) = E(Y|x)$,则有$\hat y(x)=a+bx$,称为Y对x的回归方程。b为回归系数。（a相当于$\alpha$，b相当于$\beta$,未知参数可以用不同字母代替）

当$\hat y(x)$为x的线性函数时，称为线性回归，否则称为非线性回归。

###### 一元线性回归的主要任务

1. 用n对试验值$(x_i,y_i),i=1,2,\cdots,n$,对未知参数$a,b,\sigma^2$进行点估计；
2. 对回归系数b作假设检验；
3. 在$x=x_0$处对Y作预测，即对Y作区间估计。

###### 对$\alpha,\beta,\sigma^2$进行点估计

已知变量x，Y的n对试验值$(x_i,y_i)(i=1.2.\cdots,n)$,用最小二乘法求出$\alpha,\beta$的估计值。作离差平方和。

$Q=\sum_{i=1}^n(y_i-\hat y_i)=\sum_{i=1}^n(y_i-\alpha-\beta x_i)^2$

要使Q最小，分别对$\alpha,\beta$进行求导且$\frac{dQ}{d\alpha}=\frac{dQ}{d\beta}=0$
$$
\begin{align*}
&\begin{cases}
Q_{\alpha}^{'}=-2\sum_{i=1}^n(y_i-\alpha-\beta x_i)=0 \\
Q_{\beta}^{'}=-2\sum_{i=1}^n(y_i-\alpha-\beta x_i)x_i=0
\end{cases} \Longrightarrow 正规方程组\begin{cases} 
n\alpha+\beta\sum_{i=1}^nx_i = \sum_{i=1}^n y_i \\ \alpha\sum_{i=1}^nx_i+\beta\sum_{i=1}^bx_i^2=\sum_{i=1}^nx_iy_i\end{cases} \\
&用\hat \alpha,\hat \beta取代\alpha，\beta \begin{cases} n\hat \alpha+\hat \beta\sum_{i=1}^n x_i = \sum_{i=1}^n y_i \\ \hat \alpha \sum_{i=1}^n x_i+\hat \beta\sum_{i=1}^nx_i^2=\sum_{i=1}^nx_iy_i\qquad\qquad \qquad \qquad\qquad \qquad   \\ \end{cases}\\
&方程两边都除以n\begin{cases}\hat \alpha +\hat \beta \bar x = \bar y \\ \hat \alpha \bar x+\hat \beta \bar{x^2} = \bar {xy}\end{cases} \\
&解得\begin{cases}\hat \alpha = \bar y - \hat \beta \bar x \\ \hat \beta = \frac{\bar{xy}-\bar x \bar y}{\bar{x^2}-{\bar x}^2}=\frac{\sum_{i=1}^n(x_i-\bar x)(y_i-\bar y)}{\sum_{i=1}^n(x_i-\bar x)^2}\end{cases}\\
&本方法称最小二乘法—由高斯(Gauss)建立\\
&把\hat \alpha \hat \beta代入回归直线方程得 \hat y = \hat \alpha + \hat \beta x = \bar y +\hat \beta(x-\bar x)
\end{align*} \qquad \qquad\qquad \qquad
$$
![image-20210121164529044](D:\Typora截图\image-20210121164529044.png)

对$\sigma^2$的点估计(矩估计)

已知变量(X,Y)的n次独立试验结果$(x_i,y_i)(i=1.2.\cdots,n)$,代入$Y_i = \alpha+\beta x_i+\xi_i$,其中$\xi_1,\xi_2,\cdots,\xi_n$服从$N(0,\sigma^2)$
$$
\begin{align*}
&\sigma^2 = E\xi^2=E(\frac{1}{n}\sum_{i=1}^n\xi_i^2)=E(\frac{1}{n}\sum_{i=1}^n(Y_i-\alpha-\beta x_i)^2)=E(\frac{1}{n}Q) \\
&\sigma^2的矩估计量:\hat \sigma^2=\frac{1}{n}\sum_{i=1}^n(Y_i-\hat \alpha-\hat \beta x_i)^2 = \frac{1}{n}Q_{min} \qquad (1)\\
&将\hat \alpha=\bar y -\hat \beta\bar x代入式子(1)中\\
& \hat \sigma^2 = \frac{1}{n}\sum_{i=1}^2(Y_i-\bar Y)^2 - \hat \beta^2\frac{1}{n}\sum_{i=1}^n(x_i-\bar x)^2=\frac{1}{n}\sum_{i=1}^ny_i^2-\bar y_i^2 - \hat \beta^2(\frac{1}{n}\sum_{i=1}^nx_i^2-\bar x^2)
\end{align*} \qquad\qquad\qquad\qquad\qquad\qquad\qquad
$$

###### 估计量的分布

$$
\begin{align*}
&E\hat \beta = \beta \rightarrow \hat \beta是\beta的无偏估计 \\
&D\hat \beta =\frac{\sum_{i=1}^n(x_i-\bar x)^2DY_i}{[\sum_{i=1}^n(x_i - \bar x)^2]^2}=\frac{\sigma^2}{\sum_{i=1}^n(x_i - \bar x)^2} \qquad (DY_i = \sigma^2 )\\
&因此\hat \beta \sim N(\beta,\frac{\sigma^2}{\sum_{i=1}^n(x_i - \bar x)^2}) \\
&E\hat \sigma^2 = E(\frac{1}{n}Q_{min})=\frac{n-2}{n}\sigma^2 \\
&\hat \sigma^2不是\sigma^2的无偏估计 \\
&设\hat \sigma^{*2} = \frac{1}{n-2}Q_{min} \qquad \Longrightarrow \qquad E\hat \sigma^{*2}=\sigma^2 \\
&即\hat \sigma^{*2}是\sigma^2的无偏估计 \qquad \Longrightarrow \qquad \hat \sigma^{*2} = \frac{n}{n-2}\hat \sigma^2\\
&\frac{Q_{min}}{\sigma^2} \sim \chi^2(n-2) \qquad 即\frac{(n-2)\hat \sigma^{*2}}{\sigma^2} \sim \chi^2(n-2); \\  &\hat \sigma^{*2}分别与\hat \beta,\hat \alpha独立
\end{align*} \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad \qquad
$$

#### 5.2一元线性回归中的假设检验和预测

##### 一元线性回归中的假设检验

一元回归线性模型:$Y=\alpha+\beta x + \xi,\alpha,\beta是未知参数，\xi \sim N(0,\sigma^2)$

###### 回归系数假设检验

对回归系数$\beta$作$H_0:\beta=\beta_0$,其中$\beta_0$是已知数。

已知$\hat \beta \sim N(\beta_0,\frac{\sigma^2}{\sum_{i=1}^n(x_i-\bar x)^2})$

$\Longrightarrow U=\frac{\hat \beta-\beta}{\frac{\sigma}{\sqrt{\sum_{i=1}^n(x_i-\bar x)^2}}} \sim N(0,1)$

$\sigma^2$的无偏估计量$\hat \sigma^{*2} \qquad \rightarrow \qquad \frac{(n-2){\hat \sigma^{*2}}}{\sigma^2} \sim \chi^2(n-2)$且$\hat \beta与\hat \sigma^{*2}相互独立$

$\rightarrow T=\frac{\hat \beta-\beta_0}{\hat \sigma^{*}}\sqrt{\sum_{i=1}^n(x_i-\bar x)^2} \sim t(n-2)$

当$|T| \ge t_{\frac{\alpha}{2}}(n-2)$时，拒绝$H_0$,认为线性回归显著，否则不显著。

对回归系数$\beta$作区间估计，$\beta$的置信度为$1-\alpha$的置信区间为$\left(\hat \beta-t_{\frac{\alpha}{2}}(n-2)\frac{\hat \sigma^*}{\sqrt{\sum_{i=1}^n(x_i-\bar x)^2}},\hat \beta+t_{\frac{\alpha}{2}}(n-2)\frac{\hat \sigma^*}{\sqrt{\sum_{i=1}^n(x_i-\bar x)^2}}\right)$

![image-20210121211417616](D:\Typora截图\image-20210121211417616.png)
$$
\begin{align*}
解: &(1)\bar x = 15,\bar y = 9.12 \\ 
&\hat \beta=\frac{\sum_{i=1}^5x_iy_i-5\bar{xy}}{\sum_{i=1}^5x_i^2-5\bar x^2}=0.18,\hat \beta_0 = \bar y -\hat \beta_1 \bar x =9.12-0.18*15=6.42 \\
& 故线性回归方程为:\hat y = 6.42+0.18x \\
&(2)作假设H_0:\hat \beta_1 = 0,H_1:\hat \beta_1 \ne 0 \\
&由(1)可知\hat \beta_1 = 0.18,\sum_{i=1}^5x_i^2-5\bar x^2 = 250,\hat\sigma^{*2}=\sum_{i=1}^5(y_i-\hat \alpha-\hat \beta_ix_i)^2/(5-2)=0.043\\
&假设H_0:\hat\beta_0 =0的拒绝域为|t|=\frac{|\hat \beta_1|}{\hat \sigma^*}\sqrt{\sum_{i=1}^5x_i^2-5\bar x^2} \ge 3.1824 \\
&而|t|=13.72 \ge 3.1824 .所以拒绝H_0,即线性回归效果是显著的。
\end{align*} \qquad\qquad\qquad
$$


###### 预测

对Y预测是当$x=x_0$时对Y作区间估计。
$$
\delta(x) = t_{\frac{\alpha}{2}(n-2)}\sqrt{1+\frac{1}{n}+\frac{(x_0-\bar x)^2}{\sqrt{\sum_{i=1}^n(x_i-\bar x)^2}}} \hat \sigma^*
$$
Y的置信区间为$\left(\hat y - \delta(x),\hat y+\delta(x)\right)$

![image-20210121201152882](D:\Typora截图\image-20210121201152882.png)

#### 5.3 可线性化的一元非线性回归

可以不是直线(即线性)的相关关系,而是两个变量之间的关系，而是某种曲线(即非线性)的相关关系.

![image-20210121210408912](D:\Typora截图\image-20210121210408912.png)

![image-20210121210432883](D:\Typora截图\image-20210121210432883.png)

![image-20210121210450398](D:\Typora截图\image-20210121210450398.png)

![image-20210121210511130](D:\Typora截图\image-20210121210511130.png)

![image-20210121210529822](D:\Typora截图\image-20210121210529822.png)

##### 常用曲线回归方程好坏的评价标准

$$
\begin{align*}
&1.决定系数 R^2 = 1-\frac{\sum(y_i-\hat y_i)^2}{\sum(y_i-\bar y)^2} \quad 愈大愈好 \\
&2.剩余标准差S=[\frac{\sum(y_i-\hat y_i)^2}{n-2}]^{\frac{1}{2}} \quad 愈小愈好
\end{align*} \qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad
$$

#### 5.4 多元线性回归中的参数估计

##### 模型与参数估计

设$x_1,x_2,\cdots,x_p$是可控变量，Y是依赖$x_1,x_2,\cdots,x_p$的随机变量，它们之间关系为$Y=\beta_0+\beta_1x_1+\cdots+\beta_px_p+\xi$,称为p元线性回归模型，其中$\xi \sim N(0,\sigma^2)，\beta_0,\beta_1,\cdots,\beta_p,\sigma=const$.$\beta_1,\cdots,\beta_p$为回归系数。

p元线性回归平面方程:$\hat y=EY=\beta_0+\beta_1x_1+\cdots+\beta_px_p$,其中$\beta_1,\cdots,\beta_p$为回归系数。
当$\hat y $为$x_1,x_2,\cdots,x_p$的线性函数时,称为线性回归,否则称为非线性回归。
$$
\begin{align*}
&p元线性回归模型\begin{cases}
	Y_1 = \beta_0 +\beta_1x_{11}+\beta_2x_{12}+\cdots+\beta_px_{1p}+\xi_1 \\
	Y_2 = \beta_0 +\beta_1x_{21}+\beta_2x_{22}+\cdots+\beta_px_{2p}+\xi_2 \\
	\qquad\qquad\cdots\cdots\cdots\cdots\cdots\cdots\\
		Y_n = \beta_0 +\beta_1x_{n1}+\beta_2x_{n2}+\cdots+\beta_px_{np}+\xi_n \\
\end{cases} \\
&简写为 \qquad Y=X\beta +\xi\\
&其中Y=\left[\matrix{Y_1\\Y_1\\.\\.\\.\\Y_N}\right] \qquad X=\left[\matrix{1&x_{11}&x_{12}&\cdots&x_{1p}\\1&x_{21}&x_{22}&\cdots&x_{2p}\\.&.&.&\cdots&.\\1&x_{n1}&x_{n2}&\cdots&x_{np}}\right] \qquad \beta=\left[\matrix{\beta_0\\\beta\\.\\.\\.\\\beta_n}\right] \qquad \xi=\left[\matrix{\xi_1\\\xi_2\\.\\.\\.\\\xi_n}\right]
\end{align*} \qquad\qquad\qquad
$$

$$
\begin{align*}
&未知参数\beta_0,\beta_1,\cdots,\beta_n,\sigma^2的估计,可以通过使得离差平方和Q最小来求的\\
&Q=\sum_{i=1}^n(y_i-\hat y_i)^2 =\sum_{i=1}^n(y_i-\beta_0-\beta_1x_{i1}-\cdots-\beta_px_{ip})^2=min \\
&最终可得出
\hat \beta = A^{-1}B=(X^TX)^{-1}(X^TY)\\
&\qquad\qquad\beta_0 = \bar y - \hat \beta_1\bar x_1 - \cdots-\hat \beta_p\bar x_p \\
&E(\hat \beta) = E(A^{-1}B)=E[(X^TX)^{-1}(X^TY)]=(X^TX)^{-1}X^TEY=(X^TX)^{-1}X^TE(X\beta+\xi)=(X^TX)^{-1}X^TX\beta = \beta
\end{align*}
$$

#### 5.5多元线性回归中的假设检验和预测

##### 多元线性回归的显著性检验

要检验多元线性回归模型$\begin{cases}Y=\beta_0+\beta_1x_1+\cdots+\beta_px_p+\xi \\ \xi \sim N(0,\sigma^2),\beta_0,\beta_1,\cdots,\beta_p,\sigma=const\end{cases}$

变量间有无线性联系，只要检验假设$H_0:\beta_1=\beta_2=\cdots=\beta_p=0$
$$
\begin{align*}
&Q_T=\sum_{i=1}^n(Y_i-\bar Y)^2=\sum_{i=1}^n(Y_I-\hat y_i)^2+\sum_{i=1}^n(\hat y_i-\bar Y)^2=Q_{剩}+Q_{回} \\
&F=\frac{\frac{Q_{回}}{p}}{\frac{Q_{剩}}{n-p-1}} \sim F(P,N-P-1) \\
&给定显著性水平\alpha,当 \\
&\qquad\qquad\qquad\qquad	F \ge F_{\alpha}(p,n-p-1) \\
&时拒绝H_0，即认为线性回归显著; 反之，接受H_0，即认为线性回归不显著.
\end{align*}\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad
$$


